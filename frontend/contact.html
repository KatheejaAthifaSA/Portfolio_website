<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Portfolio - Contact</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
    <style>
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #00bfff;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s, transform 0.5s;
            z-index: 10000;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(-10px);
            pointer-events: auto;
        }
    </style>
</head>

<body>
    <header>
        <a href="index.html">
            <h1>My Portfolio</h1>
        </a>
        <nav>
            <a href="projects.html">Projects</a>
            <a href="skills.html">Skills</a>
            <a href="testimonials.html">Testimonials</a>
            <a href="contact.html">Contact</a>
        </nav>
    </header>

    <section>
        <h2>Contact Me</h2>
        <form id="contactForm">
            <input type="text" id="name" placeholder="Your Name" required />
            <input type="email" id="email" placeholder="Your Email" required />
            <textarea id="message" rows="5" placeholder="Your Message" required></textarea>
            <button type="submit">Send Message</button>
        </form>
    </section>

    <footer>&copy; 2025 My Portfolio. All Rights Reserved.</footer>
    <div id="toast" class="toast"></div>

    <script>
        // âœ… Automatically handle localhost and Render URLs
        const baseUrl =
            window.location.hostname === "localhost"
                ? "http://localhost:5000/api"
                : "/api";

        function showToast(message, success = true) {
            const toast = document.getElementById("toast");
            toast.innerText = message;
            toast.style.background = success ? "#00bfff" : "#ff4d4f";
            toast.classList.add("show");
            setTimeout(() => toast.classList.remove("show"), 3000);
        }

        document
            .getElementById("contactForm")
            .addEventListener("submit", async function (e) {
                e.preventDefault();

                const name = document.getElementById("name").value.trim();
                const email = document.getElementById("email").value.trim();
                const message = document.getElementById("message").value.trim();

                if (!name || !email || !message) {
                    return showToast("Please fill out all fields.", false);
                }

                showToast("Sending...", true);

                try {
                    const response = await fetch(`${baseUrl}/contact`, {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ name, email, message }),
                    });

                    const data = await response.json().catch(() => ({}));

                    if (data.success) {
                        showToast("Message sent successfully!", true);
                        document.getElementById("contactForm").reset();
                    } else {
                        showToast("Failed to send message.", false);
                    }
                } catch (error) {
                    console.error(error);
                    showToast("Error connecting to server.", false);
                }
            });
    </script>
</body>

</html>